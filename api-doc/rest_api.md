## 1. Hint

 - **Request type:** POST
 - **Endpoint**:

     > /api/hint 

     > /api/hint/max/**{max}**

 - **Description**: Return hint list for given text 
 - **Data**: 

     - ***Request body  (required)*** – to this text will be returned hints, 
     - **max (optional)** – max hint count, default is set to 20 

 - **Returned value(json)**:

> [{   
> 	 "iri": "https://www (...) Codes-BA/Entity", 
> 	 "label": "entity", "relevancy": 6.6 }, 
> 	  (…) ]


## 2. Search Details

 - **Request type:** POST
 - **Endpoint**:

     > /api/search 

 - **Description**: Return a details about resource from given iri
 - **Data**: 

     - ***Request body (required)*** – resource iri 

 - **Returned value(json)**:

> {  "type": "details", 
> "result": { "label": "FinancialContextAndProcess", 
> "iri": "https://spec.edmcouncil.org/fibo/ontology/BP/Process/FinancialContextAndProcess/", 
> "type": null, 
> "qName": "QName: NONE:", 
> "taxonomy": [**(...)**], 
> "locationInModules":[
> "https://spec.edmcouncil.org/fibo/ontology/BP/MetadataBP/BPDomain", 
> "https://spec.edmcouncil.org/fibo/ontology/BP/Process/MetadataBPProcess/ProcessModule", 
> "https://spec.edmcouncil.org/fibo/ontology/BP/Process/FinancialContextAndProcess/"], 
> "graph": null, 
> "maturityLevel": { "label": "provisional", "iri":"https://spec.edmcouncil.org/fibo/ontology/FND/Utilities/AnnotationVocabulary/Provisional"}, 
> "properties": { **(…)** } 
> }
> }


## 3. Text search

* **Request type:** POST

 - **Endpoint**:

	 > /api/search/

	 > /api/search/max/**{max}**

	 > /api/search/page/**{page}**

	 > /api/search/max/**{max}**/page/**{page}** 

 - **Description**: Return a search results as list of sorted elements for given text from request body 
 - **Data**: 

	 - **Request body (required)** – text
	 - **max (optional)** – max result count, default 100
	 - **page (optional)** – page numer, default 1

 - **Returned value(json)**:

> {
> **"type": "list", **
> **"result":** [{ "iri": "https://spec **(...)** /LegalRight", 
> "label": "legal right", 
> "description": "a contingent right or privilege **(…)** statutes, regulations, ...", 
> "relevancy": 4.546 }, 
> **(…)**  ], 
> "**query**": "swap", 
> "**page**": 1, 
> "**hasMore**": true, 
> "**totalResult**":, 
> "**maxPage**": 15 }

## 4. Modules

* **Request type:** GET

 - **Endpoint**:

	 > /api/module

 - **Description**: Return a list of Fibo modules and all submodules from fibo ontology 
 - **Data**: 

	 - none

 - **Returned value(json)**:

> [{   "**iri**": "https://spec.edmcouncil.org/fibo/ontology/BE/MetadataBE/BEDomain", 
> "**label**": "Business Entities", 
> "**subModule**": [(next list of modules..)], 
> "**maturityLevel**": {
> "label": "prod"
> }   }, 
> (...)   ]

## 5. Add a new update request to the queue 

 - **Request type:** PUT

 - **Description**: Add a new update request to the queue and return information about it

 - **{API_KEY}** - API Key generated by Onto-Viewer

 - **API key required in header**

	- **Header:** 

		> X-API-Key: **{API_KEY}**

	- **Endpoint**:

		> /api/update  

	

- **API key required in path**

	- **Endpoint**:

		> /api/update?ApiKey=**{API_KEY}**
 		

 - **Returned value(json)**:

	>{
	 > "id": "0",
	 > "status": "IN_PROGRESS",
	  >"msg": "",
	  >"startTimestamp": 1594627080217
	>}

## 6. Get update status

 - **Request type:** GET 

 - **Description**: Return update status for given update id 

 - **API_KEY** - API Key generated by Onto-Viewer

 - **UPDATE_ID** - Generated update id

 - **API key required in header**

	- **Header:** 

		> X-API-Key: **{API_KEY}**

	- **Endpoint**:

		> /api/update?updateId=**{UPDATE_ID}**  

- **API key required in path**

	- **Endpoint**:

		> /api/update?ApiKey=**{API_KEY}**&updateId=**{UPDATE_ID}**

 - **Returned value(json)**:

	>{
	 > "id": "0",
	 > "status": "DONE",
	  >"msg": "",
	  >"startTimestamp": 1594627080217
	>}
	

 - **Possible status field values:**
	- WAITING
	- CREATED
	- IN_PROGRESS
 	- DONE 
	- ERROR
	- INTERRUPT_IN_PROGRESS

## 7. Simple stats

* **Request type:** GET

 - **Endpoint**:

	 > /api/stats

 - **Description**: Return a simple ontology stats.
 - **Data**: 

	 - none

 - **Returned value(json)**:

> {"stats":{"@viewer.stats.noDomain":10,... },
> "labels":{"@viewer.stats.noDomain":"number of domains",...}}


## 8. Actuator endpoints

### /actuator/health (GET)

#### Description

Return custom health check with additional information about initialization and update.

Detailed fields description:

- "INITIALIZATION_DONE" - `true` means that the application is initialized and ready to serve data.
- "UPDATE_ONTOLOGY_IN_PROGRESS" - `true` means that ontologies are being updated right now and the application may work incorrectly until the update is done.
- "BLOCKED" - `true` means that the resources are being replaced with new ones and the application won't serve data right now.

#### Example Response

```json
{
  "status": "UP",
  "components": {
    "custom": {
      "status": "UP",
      "details": {
        "BLOCKED": false,
        "UPDATE_ONTOLOGY_IN_PROGRESS": false,
        "INITIALIZATION_DONE": true
      }
    }
  }
}
```


### /actuator/info (GET)

#### Description

Returns detailed information about the version of the application and other related metadata.

#### Example Response

```json
{
  "git": {
    "branch": "develop",  
    "commit": {
      "id": "7e87636",
      "time": "2022-02-04T13:53:19Z"
    }
  },
  "build": {
    "artifact": "onto-viewer-web-app",
    "name": "Onto Viewer Web App",
    "time": "2022-02-01T10:00:00.000Z",
    "version": "0.4.0",
    "group": "org.edmcouncil.spec"
  }
}
```


## 9. Search logs

*  **Request type:** GET

* **Description**:

	- When the application is run, a folder "logs" is created in onto-viewer-web-app.
	- This folder contains the "viewer-logs" file with the current logs.
	- Each day a new log file is generated. The previous day's file goes into the "archiverd" 		folder and is renamed to "viewer-logs-yyyy-mm-dd".
	- If the current "viewer-logs" file has more than 1GB of data, a new file will be generated.
	- To get the logs, make a REST request, e.g: 
	<host_and_port>/api/logs?date=2022-01-21

-  **API_KEY** - API Key generated by Onto-Viewer
-  **API key required in header**
	- **Header:**
	> X-API-Key: **{API_KEY}**
-  **Endpoint**:
	> /api/logs
-  **API key required in path**
	-  **Endpoint**:
	> /api/logs?ApiKey=**{API_KEY}**
-  **Returned value(text)**:
```
[
2022-01-21 15:54:34,599 INFO org.edmcouncil.spec.ontoviewer.webapp.controller.HintController [http-nio-8080-exec-10] For hints: 'mon' (query time: '46' ms) result is:

[{iri=https://www.omg.org/spec/LCC/Languages/ISO639-2-LanguageCodes/mon, label=mon, relevancy=10.0}, {iri=https://www.omg.org/spec/LCC/Languages/ISO639-2-LanguageCodes/Hmong, label=Hmong, relevancy=6.0}, {iri=https://www.omg.org/spec/LCC/Languages/ISO639-2-LanguageCodes/Mongo, label=Mongo, relevancy=6.0},
]
```


## 10. Find search

### /api/find (GET)

#### Request Parameters
  - **term** - required; term to find entities by
  - **mode** - optional; permissible values: [`basic`, `advance`], default: `basic`
  - **findProperties** - optional; list of properties to search within
  - **useHighlighting** - optional, true by default; if true, returns results with highlightings

#### Description

Return a list of search results that match the `term`.  There are two modes: `basic` and `advance`.

- In the `basic` mode `term` is looked for within RDFS label annotation property and all its subannotations.  You don't have to specify the `mode` parameter (but you may, if you want), because the `basic` mode is the default one.

  Here is a sample basic request: `<host_and_port>/api/find?term=check`

- In the `advance`  mode a client sends a list of find properties that are then used to search for entities.  These properties are sent with the `findProperties` request parameter, and their identifiers should be delimited with a dot (`.`).  For example, this is a correct list of properties that may be sent by a client: `rdfs_label.skos_definition.purl_description`.  The list of find properties can be obtained from `/api/find/properties` (see below).

  Here is a sample advance request: `<host_and_port>/api/find?term=check&mode=advance&findProperties=rdfs_label.skos_definition`

#### Example Response

```json
[
  {
    "iri": "https://spec.edmcouncil.org/fibo/ontology/LOAN/LoanTypes/MortgageLoans/Mortgage",
    "type": "CLASS",
    "label": "mortgage",
    "highlight": "<B>mortgage</B>",
    "score": 2.9687047004699707
  },
  {
    "iri": "https://spec.edmcouncil.org/fibo/ontology/LOAN/LoanTypes/MortgageLoans/ReverseMortgage",
    "type": "CLASS",
    "label": "reverse mortgage",
    "highlight": "A reverse <B>mortgage</B> and an open end loan both have a credit limit.",
    "score": 2.458970069885254
  },
  {
    "iri": "https://spec.edmcouncil.org/fibo/ontology/LOAN/LoanTypes/MortgageLoans/MortgageLoanPurpose-MortgageModification",
    "type": "INDIVIDUAL",
    "label": "mortgage modification",
    "highlight": "<B>mortgage</B> modification",
    "score": 2.3639402389526367
  }
]
```


### /api/find/properties (GET)

#### Request Parameters

None

#### Description

Return the list of find properties supported by the application.  These properties may be used in the advance mode for searching specifically within them.

#### Example Response

```json
[
  {
    "label": "RDFS Label",
    "identifier": "rdfs_label",
    "iri": "http://www.w3.org/2000/01/rdf-schema#label"
  },
  {
    "label": "SKOS Definition",
    "identifier": "skos_definition",
    "iri": "http://www.w3.org/2004/02/skos/core#definition"
  },
  {
    "label": "FIBO Explanatory Note",
    "identifier": "fibo_explanatoryNote",
    "iri": "https://spec.edmcouncil.org/fibo/ontology/FND/Utilities/AnnotationVocabulary/explanatoryNote"
  }
]
```

## 11. Missing Imports

###  /api/missingImports (GET)

#### Description

Return the iri and the cause of the unimported ontology.

#### Example Response

```json
[
   {
   "iri": "https://www.omg.org/spec/LCC/Countries/ISO3166-1-CountryCodes/",
   "cause": "OWLOntologyCreationIOException: java.io.FileNotFoundException: https://www.omg.org/spec/LCC/Countries/ISO3166-1-CountryCodes/"
   },
   {
   "iri": "https://www.omg.org/spec/LCC/Languages/ISO639-1-LanguageCodes/",
   "cause": "OWLOntologyCreationIOException: java.io.FileNotFoundException: https://www.omg.org/spec/LCC/Languages/ISO639-1-LanguageCodes/"
   }
]
```